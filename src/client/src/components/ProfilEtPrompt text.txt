import React from "react";

export function ProfilEtPrompt({ data }) {
  if (!data) return null;

  const valeursPhares = [
    "valeur_aventure",
    "valeur_creativite",
    "valeur_securite",
    "valeur_aider",
    "valeur_autonomie",
    "valeur_curiosite",
    "valeur_collaboration",
    "valeur_reconnaissance",
    "valeur_equilibre",
    "valeur_defis",
    "valeur_justice",
    "valeur_nature",
  ];

  const buildGeminiPrompt = (data) => {
    return `
Voici le profil d‚Äôun(e) adolescent(e) :

- Pr√©nom : ${data.prenom ?? "non pr√©cis√©"}
- √Çge : ${data.age ?? "non pr√©cis√©"}
- Genre : ${data.genre ?? "non pr√©cis√©"}
- Localisation : ${data.localisation ?? "non pr√©cis√©e"}
- Disponibilit√© : ${data.disponibilite ?? "non pr√©cis√©e"}
- Centres d‚Äôint√©r√™t : ${Array.isArray(data.interet) ? data.interet.join(", ") : "non pr√©cis√©s"}
- Aspirations : ${data.aspirations ?? "non pr√©cis√©es"}
- Si l'argent n'√©tait pas un probl√®me : ${data.argent ?? "non pr√©cis√©"}
- Devise personnelle : ${data.citation ?? "non pr√©cis√©e"}
- Passions principales : ${[data.passion1, data.passion2, data.passion3, data.passion4, data.passion5].filter(Boolean).join(", ") || "non pr√©cis√©es"}
- Talents naturels : ${Array.isArray(data.talent) ? data.talent.join(", ") : "non pr√©cis√©s"}
- Inspirations : ${data.inspirations ?? "non pr√©cis√©"}
- Apprentissage hors √©cole : ${data.apprentissage ?? "non pr√©cis√©"}
- Objet pour une √Æle d√©serte : ${data.ileDeserte ?? "non pr√©cis√©"}
- Vid√©os pr√©f√©r√©es : ${data.videos ?? "non pr√©cis√©"}
- Application magique : ${data.appMagique ?? "non pr√©cis√©e"}
- Style d‚Äôapprentissage : ${Array.isArray(data.apprentissageStyle) ? data.apprentissageStyle.join(", ") : "non pr√©cis√©"}
- Valeurs : ${Array.isArray(data.valeurs_generales) ? data.valeurs_generales.join(", ") : "non pr√©cis√©es"}
- Valeurs phares : ${valeursPhares.map((key) => `${key.replace("valeur_", "")}: ${data[key] ?? "?"}`).join(", ")}
- B√©n√©volat : ${data.benevolat ?? "non pr√©cis√©"}

√Ä partir de ce profil, propose-lui des pistes d‚Äôorientation adapt√©es √† son √¢ge, ses passions, ses valeurs et son style d‚Äôapprentissage. Sois bienveillant, clair, et encourageant.
    `.trim();
  };

  const prompt = buildGeminiPrompt(data);

  return (
    <div className="mt-8 space-y-6">
      <div className="p-6 bg-indigo-50 border-l-4 border-indigo-400 rounded shadow">
        <h2 className="text-xl font-bold mb-2">üß≠ Profil d‚Äôorientation</h2>
        <p><strong>Pr√©nom :</strong> {data.prenom ?? "non pr√©cis√©"}</p>
        <p><strong>√Çge :</strong> {data.age ?? "non pr√©cis√©"}</p>
        <p><strong>Genre :</strong> {data.genre ?? "non pr√©cis√©"}</p>
        <p><strong>Localisation :</strong> {data.localisation ?? "non pr√©cis√©e"}</p>
        <p><strong>Disponibilit√© :</strong> {data.disponibilite ?? "non pr√©cis√©e"}</p>
        <p><strong>Centres d‚Äôint√©r√™t :</strong> {Array.isArray(data.interet) ? data.interet.join(", ") : "non pr√©cis√©s"}</p>
        <p><strong>Aspirations :</strong> {data.aspirations ?? "non pr√©cis√©es"}</p>
        <p><strong>Si l'argent n'√©tait pas un probl√®me :</strong> {data.argent ?? "non pr√©cis√©"}</p>
        <p><strong>Devise personnelle :</strong> {data.citation ?? "non pr√©cis√©e"}</p>
        <p><strong>Top 5 passions :</strong> {[data.passion1, data.passion2, data.passion3, data.passion4, data.passion5].filter(Boolean).join(", ") || "non pr√©cis√©es"}</p>
        <p><strong>Talents naturels :</strong> {Array.isArray(data.talent) ? data.talent.join(", ") : "non pr√©cis√©s"}</p>
        <p><strong>Ce qui t‚Äôinspire :</strong> {data.inspirations ?? "non pr√©cis√©"}</p>
        <p><strong>Ce que tu aimes apprendre en dehors de l‚Äô√©cole :</strong> {data.apprentissage ?? "non pr√©cis√©"}</p>
        <p><strong>Objet pour une √Æle d√©serte :</strong> {data.ileDeserte ?? "non pr√©cis√©"}</p>
        <p><strong>Vid√©os pr√©f√©r√©es :</strong> {data.videos ?? "non pr√©cis√©"}</p>
        <p><strong>Application magique :</strong> {data.appMagique ?? "non pr√©cis√©e"}</p>
        <p><strong>Style d‚Äôapprentissage :</strong> {Array.isArray(data.apprentissageStyle) ? data.apprentissageStyle.join(", ") : "non pr√©cis√©"}</p>
        <p><strong>Valeurs :</strong> {Array.isArray(data.valeurs_generales) ? data.valeurs_generales.join(", ") : "non pr√©cis√©es"}</p>
        <div className="mt-4">
          <strong>Valeurs phares :</strong>
          <ul className="list-disc list-inside">
            {valeursPhares.map((key) => (
              <li key={key}>
                {key.replace("valeur_", "").replaceAll("_", " ")} : {data[key] ?? "non not√©e"}
              </li>
            ))}
          </ul>
        </div>
        <p><strong>B√©n√©volat :</strong> {data.benevolat ?? "non pr√©cis√©"}</p>
      </div>

      <div className="p-6 bg-yellow-50 border-l-4 border-yellow-400 rounded shadow">
        <h2 className="text-xl font-bold mb-2">üìã Prompt envoy√© √† Gemini</h2>
        <pre className="whitespace-pre-wrap text-sm text-gray-800">{prompt}</pre>
        <button
          onClick={() => navigator.clipboard.writeText(prompt)}
          className="mt-4 px-4 py-2 bg-yellow-600 text-white rounded shadow hover:bg-yellow-700"
        >
          Copier le prompt
        </button>
      </div>
    </div>
  );
}
